---

azure:
  # List of subscription IDs
  # used to limit all scraping to these subscription IDs (if not set: use all visible subscriptions)
  #subscriptions: []

  # List of Azure locations/regions
  # used to fetch quotas for these regions
  locations: [westeurope, northeurope]

  # List of tags
  # used to attach these tags as labels ("tag_{tagname}") to metrics
  # documentation: https://github.com/webdevops/go-common/blob/main/azuresdk/README.md#tag-handling
  # examples:
  # - owner?inherit&toLower
  # - costCenter?source=resourceGroup&toLower
  # - client?source=subscription&toUpper
  # - foo?name=bar
  resourceTags: []
  resourceGroupTags: []

collectors:
  costs:
    scrapeTime: 5m

    queries:
      - # name of metric (azurerm_costs_${name})
        name: by_resourceGroup

        # metric help, optional
        help: Costs by ResourceGroup

        # optional, see https://learn.microsoft.com/en-us/rest/api/cost-management/query/usage?tabs=HTTP
        # will disable fetching by subscription and will enable fetching by scope
        #scopes: [...]
        # '/subscriptions/{subscriptionId}/' for subscription scope
        # '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}' for resourceGroup scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}' for Billing Account scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/departments/{departmentId}' for Department scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/enrollmentAccounts/{enrollmentAccountId}' for EnrollmentAccount scope
        # '/providers/Microsoft.Management/managementGroups/{managementGroupId} for Management Group scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/billingProfiles/{billingProfileId}' for billingProfile scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/billingProfiles/{billingProfileId}/invoiceSections/{invoiceSectionId}' for invoiceSection scope
        # '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/customers/{customerId}' specific for partners

        # filter by subscriptions (overwrite global subscription filter)
        #subscriptions: [...]

        # see https://learn.microsoft.com/en-us/rest/api/cost-management/query/usage?tabs=HTTP
        # for tags use format: tag:{tagname}
        #                  eg: tag:owner
        dimensions: [ResourceGroupName]

        # ActualCost, AmortizedCost
        exportType: ActualCost
        
        # None, Daily, Monthly, Accumulated
        granularity: Monthly

        timePeriod:
          fromDuration: -7200h
          toDuration: 0s

        # UsageQuantity, PreTaxCost, Cost, CostUSD, PreTaxCostUSD, see https://learn.microsoft.com/en-us/rest/api/cost-management/query/usage?tabs=HTTP
        valueField: PreTaxCost

        # see https://learn.microsoft.com/en-us/rest/api/cost-management/query/usage?tabs=HTTP
        timeFrames: [MonthToDate, YearToDate]

        # optional, additional static labels
        labels: {}
